<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>待打印普通发票(单打)</title>
<OBJECT ID=sk CLASSID="clsid:003BD8F2-A6C3-48EF-9B72-ECFD8FC4D49F"
	codebase="NISEC_SKSCX.ocx#version=1,0,0,1"> </OBJECT>
<!-- <script type="text/javascript" src="../js/jquery/jquery-2.1.1.min.js"></script> -->
<script type="text/javascript" src="../js/jquery/jquery-1.11.1.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="../bootstrap/css/bootstrap.min.css">
<script src="../bootstrap/js/bootstrap.min.js"></script>
<script type="text/javascript" src="../My97DatePicker/WdatePicker.js"></script>
<!--[if lt IE 9]>
         <script src="../js/html5shiv.js"></script>
         <script src="../js/respond.min.js"></script>
      <![endif]-->
      
<link rel="stylesheet" type="text/css" href="../js/page/pageGroup.css"/>
<script type="text/javascript" src="../js/page/pageGroup.js"></script>      
<style type="text/css">
th,td{width: 100px; height: 35px;text-align:center;}
</style>

<script type="text/javascript">
function chaxun(){
	var params = $('#queryForm').serialize();
	
	$.ajax({
		type:"GET",
        url: "../printpp/printlist",
        data: params,
        async: false,
        success: function (data) {
        	alert(JSON.stringify(data))
        		
        		$("#printBody").children().remove();
        		if(data.length>0){
    				var tbo = '';
        			for(var i=0;i<data.length;i++){
        				tbo = tbo + '<tr>'
       						+'<td class="">'+data[i].zddh+'</td>'
       						+'<td>'+data[i].hym+'</td>'
       						+'<td>'+data[i].shr+'</td>'
       						+'<td>'+data[i].sqsj+'</td>'
       						+'<td>'+data[i].kpdq+'</td>'
       						+'<td>'+data[i].fpzl+'</td>'
       						+'<td>'+data[i].fptt+'</td>'
       						+'<td>'+data[i].fpnr+'</td>'
       						+'<td>'+data[i].hjje+'</td>'
       						+'<td>'+data[i].hjse+'</td>'
       						+'<td>'+data[i].jshj+'</td>'
       						+'<td>'+data[i].kprq+'</td>'
       						+'<td>'+data[i].fpdm+'</td>'
       						+'<td>'+data[i].fphm+'</td>'
       						//+'<td>'+'<input type="button" id="dayin" value="打印" onclick="dayin(' + data[i].fpqqlsh + ')">' + '</td>'
       						+'<td>'+'<a href="javascript:" onclick="dayin(' + data[i].fpqqlsh + ');">打印</a>' + '</td>'
       						
       						+'</tr>';
        			}
        			//alert(tbo)
        			$("#printBody").html(tbo);
        			/* $('.invitetable1 tr:odd').css('background','#fffceb');
        			parent.dyniframesize('openli');  */
        		}else{
        			//alert(0)
        		}
        	
        },
        error:function(XMLHttpRequest, textStatus, errorThrown) {
        	if(XMLHttpRequest.responseText=="timeOut"){
        		location.reload();
        	}else{
        		alert("Error");
        	}
        }
	});
	
}

function dayin(ele){
	alert(ele);
}

function PrintInvoice(){	
	//01页边距设置
	//var sInputInfo = "<?xml version=\"1.0\" encoding=\"gbk\"?><business id=\"20004\"comment=\"鍙戠エ鎵撳嵃\"><body yylxdm=\"1\"><kpzdbs>12345612346</kpzdbs><fplxdm>007</fplxdm><fpdm>1110000452</fpdm><fphm>38148009</fphm><dylx>0</dylx><dyfs>0</dyfs></body></business>";
	var sMarginsInfo = " <?xml version=\"1.0\" encoding=\"gbk\"?>\r\n<business id=\"20003\" comment=\"页边距设置\">\r\n<body yylxdm=\"1\">\r\n<fplxdm>1</fplxdm>\r\n<top>-1</top>\r\n<left>-3</left>\r\n</body>\r\n</business>";		
	sMargret = sk.Operate(sMarginsInfo);
	var returncodesMarg = getTotalMidValue(sMargret, "<returncode>","</returncode>");
	var returnmsgsMarg = getTotalMidValue(sMargret, "<returnmsg>","</returnmsg>");	
	if(returncodesMarg==0&&returnmsgsMarg=="成功"){
		//02、打印发票
		var sPrintInfo = "<?xml version=\"1.0\" encoding=\"gbk\"?><business id=\"20004\"comment=\"发票打印\"><body yylxdm=\"1\"><kpzdbs>0601</kpzdbs><fplxdm>004</fplxdm><fpdm>1100098082</fpdm><fphm>74560017</fphm><dylx>0</dylx><dyfs>0</dyfs></body></business>";
		alert(sPrintInfo);
		sPrintInret = sk.Operate(sPrintInfo);
		var returncodesPrintIn = getTotalMidValue(sPrintInret, "<returncode>","</returncode>");
		var returnmsgsPrintIn = getTotalMidValue(sPrintInret, "<returnmsg>","</returnmsg>");
		if(returncodesPrintIn==0&&returnmsgsPrintIn=="成功"){
			alert("打印成功！");
		}else{
			alert("打印失败，失败原因："+returnmsgsPrintIn);
		}
	}else{
		    alert("页面距设置失败，失败原因："+returnmsgsMarg);
	}		
		
}

</script>

</head>
<body>
<h4>查询条件</h4>
<form id="queryForm" name='queryForm' class="form-horizontal" role="form">
	<div class="form-inline form-group">
		<div class="form-group col-sm-5">
	      <label for="beginDate" class="col-sm-3 control-label">开票起止日期：</label>
	      <div class="col-sm-3">
	         <input type="text" class="form-control" id="beginDate" name="beginDate" placeholder="起始时间" value=""
	         	onfocus="var endDate=$dp.$('endDate');WdatePicker({dateFmt:'yyyy-MM-dd',readOnly:true,onpicked:function(){endDate.focus();},maxDate:'#F{$dp.$D(\'endDate\')}'})">
	      </div>
	      <div class="col-sm-3">
	         <input type="text" class="form-control" id="endDate" name="endDate" placeholder="结束时间" value=""
	         	onfocus="WdatePicker({dateFmt:'yyyy-MM-dd',readOnly:true,minDate:'#F{$dp.$D(\'beginDate\')}'})">
	      </div>
	   </div>
	   <div class="form-group col-sm-5">
	      <label for="kpdq" class="col-sm-3 control-label">开票地区：</label>
	      <div class="col-sm-3">
	         <select class="form-control" id="kpdq" name="kpdq">
		         <option value="">请选择</option>
		         <option value="0">北京</option>
			 	 <option value="1">上海</option>
		     </select>
	      </div>
	   </div>
	</div>
	
	<div class="form-inline form-group">
		<div class="form-group col-sm-5">
	      <label for="zddh" class="col-sm-3 control-label">订单号：</label>
	      <div class="col-sm-6">
	         <input type="text" class="form-control" id="zddh" name="zddh" placeholder="订单号">
	         <input type="hidden" id='fplx' name='fplx' value='007'><!-- 发票类型 普票 -->
	      </div>
	   </div>
	   <div class="form-group col-sm-5">
	      <div class="col-sm-offset-2 col-sm-10">
	         <button type="button" class="btn btn-default" onclick="chaxun();">查询</button>
	      </div>
	   </div>
	</div>
</form>

<hr>


<table border="1" cellspacing="0" >
<thead>
	<th>订单号</th>
	<th>会员名</th>
	<th>收货人</th>
	<th>申请时间</th>
	<th>开票地区</th>
	<th>发票种类</th>
	<th>发票抬头</th>
	<th>发票内容</th>
	<th>合计金额</th>
	<th>合计税额</th>
	<th>价税合计</th>
	<th>开票日期</th>
	<th>发票代码</th>
	<th>发票号码</th>
	<th>操作</th>
</thead>

<tbody id="printBody">
<!-- <tr>
<td>123123</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr> -->

</tbody>

</table>
<!-- <div class="">pager
<ul class="pagination">
  <li><a href="#">&laquo;</a></li>
  <li class="active"><a href="#">1</a></li>
  <li class="disabled"><a href="#">2</a></li>
  <li><a href="#">3</a></li>
  <li><a href="#">4</a></li>
  <li><a href="#">5</a></li>
  <li><a href="#">&raquo;</a></li>
</ul>
</div> -->

<div id="pageGro" class="cb">
	<div class="pageUp">上一页</div>
    <div class="pageList">
        <ul>
            <li>1</li>
            <li>2</li>
            <li>3</li>
            <li>4</li>
            <li>5</li>
        </ul>
    </div>
    <div class="pageDown">下一页</div>
</div>



</body>
</html>