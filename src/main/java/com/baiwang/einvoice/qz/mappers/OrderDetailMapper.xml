<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.baiwang.einvoice.qz.dao.OrderDetailMapper" >
  <resultMap id="BaseResultMap" type="com.baiwang.einvoice.qz.beans.OrderDetail" >
    <id column="id" property="id" jdbcType="BIGINT" />
    <result column="fpqqlsh" property="fpqqlsh" jdbcType="VARCHAR" />
    <result column="zddh" property="zddh" jdbcType="VARCHAR" />
    <result column="fddh" property="fddh" jdbcType="VARCHAR" />
    <result column="kpdq" property="kpdq" jdbcType="TINYINT" />
    <result column="sqr" property="sqr" jdbcType="VARCHAR" />
    <result column="hym" property="hym" jdbcType="VARCHAR" />
    <result column="hyid" property="hyid" jdbcType="VARCHAR" />
    <result column="ddsj" property="ddsj" jdbcType="DATE" />
    <result column="sqsj" property="sqsj" jdbcType="DATE" />
    <result column="spzl" property="spzl" jdbcType="VARCHAR" />
    <result column="sqrk" property="sqrk" jdbcType="VARCHAR" />
    <result column="shr" property="shr" jdbcType="VARCHAR" />
    <result column="shrdh" property="shrdh" jdbcType="VARCHAR" />
    <result column="jsdz" property="jsdz" jdbcType="VARCHAR" />
    <result column="yjsj" property="yjsj" jdbcType="DATE" />
    <result column="fhr" property="fhr" jdbcType="VARCHAR" />
    <result column="wlgs" property="wlgs" jdbcType="VARCHAR" />
    <result column="wldh" property="wldh" jdbcType="VARCHAR" />
    <result column="tkzt" property="tkzt" jdbcType="VARCHAR" />
    <result column="fpzt" property="fpzt" jdbcType="VARCHAR" />
  </resultMap>
  
   <resultMap id="QueryMap" type="hashmap">
    <result column="fpqqlsh" property="fpqqlsh" jdbcType="VARCHAR" />
    <result column="zddh" property="zddh" jdbcType="VARCHAR" />
    <result column="fddh" property="fddh" jdbcType="VARCHAR" />
    <result column="kpdq" property="kpdq" jdbcType="TINYINT" />
    <result column="kprq" property="kprq" jdbcType="VARCHAR" /> 
    <result column="hym" property="hym" jdbcType="VARCHAR" />
    <result column="sqsj" property="sqsj" jdbcType="DATE" />
    <result column="spzl" property="spzl" jdbcType="VARCHAR" />
    <result column="shr" property="shr" jdbcType="VARCHAR" />
    <result column="jshj" property="jshj" jdbcType="REAL" />
    <result column="hjje" property="hjje" jdbcType="REAL" />
    <result column="hjse" property="hjse" jdbcType="REAL" />
    <result column="gmfmc" property="gmfmc" jdbcType="VARCHAR" />
    <result column="fplx" property="fplx" jdbcType="VARCHAR" />
  </resultMap>
  <resultMap id="QueryMap4zf" type="map">
    <result column="fpqqlsh" property="fpqqlsh" jdbcType="VARCHAR" />
    <result column="zddh" property="zddh" jdbcType="VARCHAR" />
    <result column="fddh" property="fddh" jdbcType="VARCHAR" />
    <result column="hym" property="hym" jdbcType="VARCHAR" />
    <result column="hyid" property="hyid" jdbcType="VARCHAR" />
    <result column="shr" property="shr" jdbcType="VARCHAR" />
    <result column="shrdh" property="shrdh" jdbcType="VARCHAR" />
    <result column="sqsj" property="sqsj" jdbcType="DATE" />
    <result column="gmfmc" property="gmfmc" jdbcType="VARCHAR" />
    <result column="spzl" property="spzl" jdbcType="VARCHAR" />
    <result column="hjje" property="hjje" jdbcType="REAL" />
    <result column="hjse" property="hjse" jdbcType="REAL" />
    <result column="jshj" property="jshj" jdbcType="REAL" />
    <result column="kplx" property="kplx" jdbcType="REAL" />
    <result column="kprq" property="kprq" jdbcType="VARCHAR" />
    <result column="fpdm" property="fpdm" jdbcType="VARCHAR" />
    <result column="fphm" property="fphm" jdbcType="VARCHAR" />
  </resultMap>
  <sql id="Base_Column_List" >
    id, fpqqlsh,zddh,fddh, kpdq,sqr, hym, hyid, ddsj, sqsj, spzl, sqrk, shr, shrdh, jsdz, yjsj, fhr, wlgs, 
    wldh, tkzt, fpzt
  </sql>
  <select id="selectByPrimaryKey" resultMap="BaseResultMap" parameterType="java.lang.Long" >
    select 
    <include refid="Base_Column_List" />
    from order_detail
    where id = #{id,jdbcType=BIGINT}
  </select>
  
  <select id="selectByDdh" resultMap="BaseResultMap" parameterType="java.lang.String" >
    select 
    <include refid="Base_Column_List" />
    from order_detail
    where zddh = #{zddh,jdbcType=VARCHAR} and fddh = #{fddh,jdbcType=VARCHAR}
  </select>
  
  <delete id="deleteByFpqqlsh" parameterType="java.lang.String" >
    delete from order_detail
    where fpqqlsh = #{fpqqlsh,jdbcType=VARCHAR}
  </delete>
  
  <delete id="deleteByPrimaryKey" parameterType="java.lang.Long" >
    delete from order_detail
    where id = #{id,jdbcType=BIGINT}
  </delete>
  <insert id="insert" parameterType="com.baiwang.einvoice.qz.beans.OrderDetail" >
    insert into order_detail (id, fpqqlsh, zddh, fddh,kpdq, sqr, 
      hym, hyid, ddsj, sqsj, 
      spzl, sqrk, shr, shrdh, 
      jsdz, yjsj, fhr, wlgs, 
      wldh, tkzt, fpzt)
    values (#{id,jdbcType=BIGINT}, #{fpqqlsh,jdbcType=VARCHAR},#{zddh,jdbcType=VARCHAR},#{fddh,jdbcType=VARCHAR},
      #{kpdq,jdbcType=VARCHAR},#{sqr,jdbcType=VARCHAR}, 
      #{hym,jdbcType=VARCHAR}, #{hyid,jdbcType=VARCHAR}, #{ddsj,jdbcType=DATE}, #{sqsj,jdbcType=DATE}, 
      #{spzl,jdbcType=VARCHAR}, #{sqrk,jdbcType=VARCHAR}, #{shr,jdbcType=VARCHAR}, #{shrdh,jdbcType=VARCHAR}, 
      #{jsdz,jdbcType=VARCHAR}, #{yjsj,jdbcType=DATE}, #{fhr,jdbcType=VARCHAR}, #{wlgs,jdbcType=VARCHAR}, 
      #{wldh,jdbcType=VARCHAR}, #{tkzt,jdbcType=VARCHAR}, #{fpzt,jdbcType=VARCHAR})
  </insert>
  <insert id="insertSelective" parameterType="com.baiwang.einvoice.qz.beans.OrderDetail" >
    insert into order_detail
    <trim prefix="(" suffix=")" suffixOverrides="," >
      <if test="id != null" >
        id,
      </if>
      <if test="fpqqlsh != null" >
        fpqqlsh,
      </if>
      <if test="zddh != null" >
        zddh,
      </if>
      <if test="fddh != null" >
        fddh,
      </if>
      <if test="kpdq != null" >
        kpdq,
      </if>
      <if test="sqr != null" >
        sqr,
      </if>
      <if test="hym != null" >
        hym,
      </if>
      <if test="hyid != null" >
        hyid,
      </if>
      <if test="ddsj != null" >
        ddsj,
      </if>
      <if test="sqsj != null" >
        sqsj,
      </if>
      <if test="spzl != null" >
        spzl,
      </if>
      <if test="sqrk != null" >
        sqrk,
      </if>
      <if test="shr != null" >
        shr,
      </if>
      <if test="shrdh != null" >
        shrdh,
      </if>
      <if test="jsdz != null" >
        jsdz,
      </if>
      <if test="yjsj != null" >
        yjsj,
      </if>
      <if test="fhr != null" >
        fhr,
      </if>
      <if test="wlgs != null" >
        wlgs,
      </if>
      <if test="wldh != null" >
        wldh,
      </if>
      <if test="tkzt != null" >
        tkzt,
      </if>
      <if test="fpzt != null" >
        fpzt,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides="," >
      <if test="id != null" >
        #{id,jdbcType=BIGINT},
      </if>
      <if test="fpqqlsh != null" >
        #{fpqqlsh,jdbcType=VARCHAR},
      </if>
      <if test="zddh != null" >
        #{zddh,jdbcType=VARCHAR},
      </if>
      <if test="fddh != null" >
        #{fddh,jdbcType=VARCHAR},
      </if>
      <if test="kpdq != null" >
        #{kpdq,jdbcType=VARCHAR},
      </if>
      <if test="sqr != null" >
        #{sqr,jdbcType=VARCHAR},
      </if>
      <if test="hym != null" >
        #{hym,jdbcType=VARCHAR},
      </if>
      <if test="hyid != null" >
        #{hyid,jdbcType=VARCHAR},
      </if>
      <if test="ddsj != null" >
        #{ddsj,jdbcType=DATE},
      </if>
      <if test="sqsj != null" >
        #{sqsj,jdbcType=DATE},
      </if>
      <if test="spzl != null" >
        #{spzl,jdbcType=VARCHAR},
      </if>
      <if test="sqrk != null" >
        #{sqrk,jdbcType=VARCHAR},
      </if>
      <if test="shr != null" >
        #{shr,jdbcType=VARCHAR},
      </if>
      <if test="shrdh != null" >
        #{shrdh,jdbcType=VARCHAR},
      </if>
      <if test="jsdz != null" >
        #{jsdz,jdbcType=VARCHAR},
      </if>
      <if test="yjsj != null" >
        #{yjsj,jdbcType=DATE},
      </if>
      <if test="fhr != null" >
        #{fhr,jdbcType=VARCHAR},
      </if>
      <if test="wlgs != null" >
        #{wlgs,jdbcType=VARCHAR},
      </if>
      <if test="wldh != null" >
        #{wldh,jdbcType=VARCHAR},
      </if>
      <if test="tkzt != null" >
        #{tkzt,jdbcType=VARCHAR},
      </if>
      <if test="fpzt != null" >
        #{fpzt,jdbcType=VARCHAR},
      </if>
    </trim>
  </insert>
  <update id="updateByPrimaryKeySelective" parameterType="com.baiwang.einvoice.qz.beans.OrderDetail" >
    update order_detail
    <set >
      <if test="fpqqlsh != null" >
        fpqqlsh = #{fpqqlsh,jdbcType=VARCHAR},
      </if>
      <if test="zddh != null" >
        zddh = #{zddh,jdbcType=VARCHAR},
      </if>
      <if test="fddh != null" >
        fddh = #{fddh,jdbcType=VARCHAR},
      </if>
       <if test="kpdq != null" >
        kpdq = #{kpdq,jdbcType=VARCHAR},
      </if>
      <if test="sqr != null" >
        sqr = #{sqr,jdbcType=VARCHAR},
      </if>
      <if test="hym != null" >
        hym = #{hym,jdbcType=VARCHAR},
      </if>
      <if test="hyid != null" >
        hyid = #{hyid,jdbcType=VARCHAR},
      </if>
      <if test="ddsj != null" >
        ddsj = #{ddsj,jdbcType=DATE},
      </if>
      <if test="sqsj != null" >
        sqsj = #{sqsj,jdbcType=DATE},
      </if>
      <if test="spzl != null" >
        spzl = #{spzl,jdbcType=VARCHAR},
      </if>
      <if test="sqrk != null" >
        sqrk = #{sqrk,jdbcType=VARCHAR},
      </if>
      <if test="shr != null" >
        shr = #{shr,jdbcType=VARCHAR},
      </if>
      <if test="shrdh != null" >
        shrdh = #{shrdh,jdbcType=VARCHAR},
      </if>
      <if test="jsdz != null" >
        jsdz = #{jsdz,jdbcType=VARCHAR},
      </if>
      <if test="yjsj != null" >
        yjsj = #{yjsj,jdbcType=DATE},
      </if>
      <if test="fhr != null" >
        fhr = #{fhr,jdbcType=VARCHAR},
      </if>
      <if test="wlgs != null" >
        wlgs = #{wlgs,jdbcType=VARCHAR},
      </if>
      <if test="wldh != null" >
        wldh = #{wldh,jdbcType=VARCHAR},
      </if>
      <if test="tkzt != null" >
        tkzt = #{tkzt,jdbcType=VARCHAR},
      </if>
      <if test="fpzt != null" >
        fpzt = #{fpzt,jdbcType=VARCHAR},
      </if>
    </set>
    where id = #{id,jdbcType=BIGINT}
  </update>
  <update id="updateByPrimaryKey" parameterType="com.baiwang.einvoice.qz.beans.OrderDetail" >
    update order_detail
    set fpqqlsh = #{ddh = #{ddh,jdbcType=VARCHAR},,jdbcType=VARCHAR},
      zddh = #{zddh,jdbcType=VARCHAR},
      fddh = #{fddh,jdbcType=VARCHAR},
      kpdq = #{kpdq,jdbcType=VARCHAR},
      sqr = #{sqr,jdbcType=VARCHAR},
      hym = #{hym,jdbcType=VARCHAR},
      hyid = #{hyid,jdbcType=VARCHAR},
      ddsj = #{ddsj,jdbcType=DATE},
      sqsj = #{sqsj,jdbcType=DATE},
      spzl = #{spzl,jdbcType=VARCHAR},
      sqrk = #{sqrk,jdbcType=VARCHAR},
      shr = #{shr,jdbcType=VARCHAR},
      shrdh = #{shrdh,jdbcType=VARCHAR},
      jsdz = #{jsdz,jdbcType=VARCHAR},
      yjsj = #{yjsj,jdbcType=DATE},
      fhr = #{fhr,jdbcType=VARCHAR},
      wlgs = #{wlgs,jdbcType=VARCHAR},
      wldh = #{wldh,jdbcType=VARCHAR},
      tkzt = #{tkzt,jdbcType=VARCHAR},
      fpzt = #{fpzt,jdbcType=VARCHAR}
    where id = #{id,jdbcType=BIGINT}
  </update>
  
   <select id="getPlainList" resultMap="QueryMap" parameterType="map" >
	select a.fpqqlsh,b.zddh,b.fddh,
	b.hym,b.shr,b.sqsj,b.kpdq,b.spzl,a.gmfmc,a.jshj,a.hjse,a.hjje,a.fplx
	from kpxx a
	LEFT JOIN order_detail b
	ON a.zddh = b.zddh
	AND a.fddh = b.fddh
	WHERE a.fpzt = '1' and a.fplx = '007' 
    <if test="beginDate != null and beginDate != ''" >
     <![CDATA[and b.ddsj >= #{beginDate} ]]>
    </if>
    <if test="endDate != null and endDate != ''" >
     <![CDATA[and b.ddsj <= #{endDate} ]]>
    </if>
    <if test="zddh != null" >
     and b.zddh like CONCAT('%',#{zddh },'%' )
    </if>
    <if test="kpdq != null and kpdq != '-1'" >
     and b.kpdq = #{kpdq}
    </if>
  </select>
  
  <select id="getSpecialList" resultMap="QueryMap" parameterType="map" >
	select a.fpqqlsh,b.zddh,b.fddh,
	b.hym,b.shr,b.sqsj,b.kpdq,b.spzl,a.gmfmc,a.jshj,a.hjse,a.hjje,a.fplx
	from kpxx a
	LEFT JOIN order_detail b
	ON a.zddh = b.zddh
	AND a.fddh = b.fddh
	WHERE a.fpzt = '1' and  a.fplx = '004'
    <if test="beginDate != null and beginDate != ''" >
     <![CDATA[and b.ddsj >= #{beginDate} ]]>
    </if>
    <if test="endDate != null and endDate != ''" >
     <![CDATA[and b.ddsj <= #{endDate} ]]>
    </if>
    <if test="zddh != null" >
     and b.zddh like CONCAT('%',#{zddh },'%' )
    </if>
    <if test="kpdq != null and kpdq != '-1'" >
     and b.kpdq = #{kpdq}
    </if>
  </select>
  
  <select id="getPlainList4zf" resultMap="QueryMap4zf" parameterType="map" >
	select k.fpqqlsh,k.zddh,k.fddh,o.hym,o.hyid,o.shr,o.shrdh,o.sqsj,
	k.gmfmc,o.spzl,k.hjje,k.hjse,k.jshj,k.kplx,k.kprq,k.fpdm,k.fphm
	from order_detail o,kpxx k where o.fpqqlsh=k.fpqqlsh and k.fpzt = '3' and k.fplx = '007'
    <if test="beginDate != null and beginDate != ''" >
     <![CDATA[and k.kprq >= #{beginDate} ]]>
    </if>
    <if test="endDate != null and endDate != ''" >
     <![CDATA[and k.kprq <= #{endDate} ]]>
    </if>
    <if test="hyid4q != null and hyid4q != '' " >
     and o.hyid like CONCAT('%',#{hyid4q },'%' )
    </if>
    <if test="fphm4q != null and fphm4q != '' " >
     and k.fphm like CONCAT('%',#{fphm4q },'%' )
    </if>
    <if test="ddh4q != null and ddh4q != '' " >
     and k.zddh like CONCAT('%',#{ddh4q },'%' )
    </if>
    <if test="sjh4q != null and sjh4q != '' " >
     and o.shrdh like CONCAT('%',#{sjh4q },'%' )
    </if>
  </select>
  
  <select id="getSpecialList4zf" resultMap="QueryMap4zf" parameterType="map" >
	select k.fpqqlsh,k.zddh,k.fddh,o.hym,o.hyid,o.shr,o.shrdh,o.sqsj,
	k.gmfmc,o.spzl,k.hjje,k.hjse,k.jshj,k.kplx,k.kprq,k.fpdm,k.fphm
	from order_detail o,kpxx k where o.fpqqlsh=k.fpqqlsh and k.fpzt = '3' and k.fplx = '004'
    <if test="beginDate != null and beginDate != ''" >
     <![CDATA[and k.kprq >= #{beginDate} ]]>
    </if>
    <if test="endDate != null and endDate != ''" >
     <![CDATA[and k.kprq <= #{endDate} ]]>
    </if>
    <if test="hyid4q != null and hyid4q != '' " >
     and o.hyid like CONCAT('%',#{hyid4q },'%' )
    </if>
    <if test="fphm4q != null and fphm4q != '' " >
     and k.fphm like CONCAT('%',#{fphm4q },'%' )
    </if>
    <if test="ddh4q != null and ddh4q != '' " >
     and k.zddh like CONCAT('%',#{ddh4q },'%' )
    </if>
    <if test="sjh4q != null and sjh4q != '' " >
     and o.shrdh like CONCAT('%',#{sjh4q },'%' )
    </if>
  </select>
</mapper>